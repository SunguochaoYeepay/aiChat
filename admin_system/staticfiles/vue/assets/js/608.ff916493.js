"use strict";(self["webpackChunkdesign_helper_frontend"]=self["webpackChunkdesign_helper_frontend"]||[]).push([[608],{9608:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var l=t(6254),n=t(8627);const s={class:"api-test"},o=["onClick"],r={style:{"margin-top":"8px"}},u={key:0,class:"response-container"},i={class:"response-header"},d={class:"response-time"},c={class:"response-body"},p={key:1,class:"no-response"};function v(e,a,t,v,m,y){const k=(0,l.g2)("a-page-header"),h=(0,l.g2)("a-input-search"),g=(0,l.g2)("a-list-item-meta"),f=(0,l.g2)("a-tag"),b=(0,l.g2)("a-list-item"),_=(0,l.g2)("a-list"),F=(0,l.g2)("a-card"),E=(0,l.g2)("a-col"),w=(0,l.g2)("a-divider"),K=(0,l.g2)("a-input"),C=(0,l.g2)("a-form-item"),S=(0,l.g2)("a-textarea"),P=(0,l.g2)("a-button"),A=(0,l.g2)("a-row"),R=(0,l.g2)("a-select-option"),T=(0,l.g2)("a-select"),I=(0,l.g2)("a-form"),W=(0,l.g2)("a-tab-pane"),O=(0,l.g2)("a-table"),q=(0,l.g2)("a-tabs"),x=(0,l.g2)("a-empty");return(0,l.uX)(),(0,l.CE)("div",s,[(0,l.bF)(k,{title:"API 测试","sub-title":"测试系统 API 接口"}),(0,l.bF)(F,{class:"api-test-content"},{default:(0,l.k6)((()=>[(0,l.bF)(A,{gutter:16},{default:(0,l.k6)((()=>[(0,l.bF)(E,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(F,{title:"API 接口列表",class:"endpoint-list"},{default:(0,l.k6)((()=>[(0,l.bF)(h,{value:v.searchKeyword,"onUpdate:value":a[0]||(a[0]=e=>v.searchKeyword=e),placeholder:"搜索 API 接口",style:{"margin-bottom":"16px"},onSearch:v.onSearch},null,8,["value","onSearch"]),(0,l.bF)(_,{size:"small",loading:v.loading,"data-source":v.filteredEndpoints,pagination:{pageSize:10}},{renderItem:(0,l.k6)((({item:e})=>[(0,l.bF)(b,null,{actions:(0,l.k6)((()=>[(0,l.bF)(f,{color:"GET"===e.method?"blue":"POST"===e.method?"green":"PUT"===e.method?"orange":"red"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.method),1)])),_:2},1032,["color"])])),default:(0,l.k6)((()=>[(0,l.bF)(g,{title:e.name,description:e.path},{title:(0,l.k6)((()=>[(0,l.Lk)("a",{onClick:a=>v.selectEndpoint(e)},(0,n.v_)(e.name),9,o)])),_:2},1032,["title","description"])])),_:2},1024)])),_:1},8,["loading","data-source"])])),_:1})])),_:1}),(0,l.bF)(E,{span:16},{default:(0,l.k6)((()=>[v.currentEndpoint.id?((0,l.uX)(),(0,l.Wv)(F,{key:0,title:v.currentEndpoint.name,class:"api-form"},{default:(0,l.k6)((()=>[(0,l.Lk)("p",null,(0,n.v_)(v.currentEndpoint.description),1),(0,l.bF)(w),(0,l.bF)(I,{layout:"vertical"},{default:(0,l.k6)((()=>[(0,l.bF)(C,{label:"请求路径"},{default:(0,l.k6)((()=>[(0,l.bF)(K,{value:v.currentEndpoint.path,disabled:""},null,8,["value"])])),_:1}),(0,l.bF)(C,{label:"请求方法"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{color:"GET"===v.currentEndpoint.method?"blue":"POST"===v.currentEndpoint.method?"green":"PUT"===v.currentEndpoint.method?"orange":"red",style:{"font-size":"14px",padding:"4px 8px"}},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(v.currentEndpoint.method),1)])),_:1},8,["color"])])),_:1}),"GET"!==v.currentEndpoint.method?((0,l.uX)(),(0,l.Wv)(C,{key:0,label:"请求体"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{value:v.requestBody,"onUpdate:value":a[1]||(a[1]=e=>v.requestBody=e),rows:8,placeholder:"输入 JSON 格式的请求体"},null,8,["value"]),(0,l.Lk)("div",r,[(0,l.bF)(P,{onClick:v.formatJson,size:"small"},{default:(0,l.k6)((()=>a[4]||(a[4]=[(0,l.eW)("格式化 JSON")]))),_:1},8,["onClick"]),(0,l.bF)(P,{onClick:v.clearRequestBody,size:"small",style:{"margin-left":"8px"}},{default:(0,l.k6)((()=>a[5]||(a[5]=[(0,l.eW)(" 清空 ")]))),_:1},8,["onClick"])])])),_:1})):(0,l.Q3)("",!0),"GET"===v.currentEndpoint.method?((0,l.uX)(),(0,l.Wv)(C,{key:1,label:"查询参数"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(v.queryParams,((e,t)=>((0,l.uX)(),(0,l.Wv)(A,{key:t,gutter:8,style:{"margin-bottom":"8px"}},{default:(0,l.k6)((()=>[(0,l.bF)(E,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(K,{value:e.key,"onUpdate:value":a=>e.key=a,placeholder:"参数名"},null,8,["value","onUpdate:value"])])),_:2},1024),(0,l.bF)(E,{span:14},{default:(0,l.k6)((()=>[(0,l.bF)(K,{value:e.value,"onUpdate:value":a=>e.value=a,placeholder:"参数值"},null,8,["value","onUpdate:value"])])),_:2},1024),(0,l.bF)(E,{span:2},{default:(0,l.k6)((()=>[(0,l.bF)(P,{type:"danger",shape:"circle",onClick:e=>v.removeQueryParam(t)},{default:(0,l.k6)((()=>a[6]||(a[6]=[(0,l.eW)(" - ")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),(0,l.bF)(P,{onClick:v.addQueryParam,style:{width:"100%"}},{default:(0,l.k6)((()=>a[7]||(a[7]=[(0,l.eW)(" 添加参数 ")]))),_:1},8,["onClick"])])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(C,{label:"API 密钥 (可选)"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{value:v.selectedApiKey,"onUpdate:value":a[2]||(a[2]=e=>v.selectedApiKey=e),style:{width:"100%"},placeholder:"选择 API 密钥","allow-clear":""},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(v.apiKeys,(e=>((0,l.uX)(),(0,l.Wv)(R,{key:e.id,value:e.key},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(P,{type:"primary",onClick:v.sendRequest,loading:v.sending},{default:(0,l.k6)((()=>a[8]||(a[8]=[(0,l.eW)(" 发送请求 ")]))),_:1},8,["onClick","loading"])])),_:1})])),_:1}),(0,l.bF)(w,null,{default:(0,l.k6)((()=>a[9]||(a[9]=[(0,l.eW)("响应")]))),_:1}),v.response?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",i,[(0,l.bF)(f,{color:v.getStatusColor(v.responseStatus)},{default:(0,l.k6)((()=>[(0,l.eW)(" 状态码: "+(0,n.v_)(v.responseStatus),1)])),_:1},8,["color"]),(0,l.Lk)("span",d," 响应时间: "+(0,n.v_)(v.responseTime)+"ms ",1)]),(0,l.bF)(q,{activeKey:v.activeResponseTab,"onUpdate:activeKey":a[3]||(a[3]=e=>v.activeResponseTab=e)},{default:(0,l.k6)((()=>[(0,l.bF)(W,{key:"body",tab:"响应体"},{default:(0,l.k6)((()=>[(0,l.Lk)("pre",c,(0,n.v_)(v.formattedResponse),1)])),_:1}),(0,l.bF)(W,{key:"headers",tab:"响应头"},{default:(0,l.k6)((()=>[(0,l.bF)(O,{columns:v.headerColumns,"data-source":v.responseHeaders,size:"small",pagination:!1},null,8,["columns","data-source"])])),_:1})])),_:1},8,["activeKey"])])):v.sending?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",p,a[10]||(a[10]=[(0,l.Lk)("p",null,"发送请求后将在此处显示响应",-1)])))])),_:1},8,["title"])):((0,l.uX)(),(0,l.Wv)(x,{key:1,description:"请从左侧选择 API 接口"}))])),_:1})])),_:1})])),_:1})])}var m=t(5598),y=t(3163);const k={name:"ApiTest",setup(){const e=(0,m.KR)(!1),a=(0,m.KR)(!1),t=(0,m.KR)([]),n=(0,m.KR)(""),s=(0,m.KR)("body"),o=(0,m.KR)(""),r=(0,m.KR)([]),u=(0,m.KR)(null),i=(0,m.KR)(0),d=(0,m.KR)(0),c=(0,m.KR)([]),p=(0,m.KR)(""),v=(0,m.KR)([{key:"",value:""}]),k=(0,m.Kh)({id:null,name:"",path:"",method:"",description:""}),h=[{title:"名称",dataIndex:"name",key:"name"},{title:"值",dataIndex:"value",key:"value"}],g=(0,l.EW)((()=>{if(!n.value)return t.value;const e=n.value.toLowerCase();return t.value.filter((a=>a.name.toLowerCase().includes(e)||a.path.toLowerCase().includes(e)))})),f=(0,l.EW)((()=>{if(!u.value)return"";try{return JSON.stringify(u.value,null,2)}catch(e){return u.value}})),b=async()=>{e.value=!0;try{const e=await fetch("/api/v1/endpoints"),a=await e.json();a.endpoints?t.value=a.endpoints:T()}catch(a){console.error("加载 API 接口列表失败:",a),T()}finally{e.value=!1}},_=async()=>{try{const e=await fetch("/api/v1/api-keys"),a=await e.json();a.api_keys?r.value=a.api_keys:r.value=[{id:1,name:"默认密钥",key:"sk-demo-key-12345"},{id:2,name:"测试密钥",key:"sk-test-key-67890"}]}catch(e){console.error("加载 API 密钥失败:",e),r.value=[{id:1,name:"默认密钥",key:"sk-demo-key-12345"},{id:2,name:"测试密钥",key:"sk-test-key-67890"}]}},F=e=>{if(Object.assign(k,e),p.value="",v.value=[{key:"",value:""}],u.value=null,i.value=0,d.value=0,c.value=[],e.request_schema)try{p.value=JSON.stringify(e.request_schema,null,2)}catch(a){}},E=()=>{},w=()=>{if(p.value)try{const e=JSON.parse(p.value);p.value=JSON.stringify(e,null,2)}catch(e){y.Ay.error("JSON 格式错误: "+e.message)}},K=()=>{p.value=""},C=()=>{v.value.push({key:"",value:""})},S=e=>{v.value.splice(e,1),0===v.value.length&&C()},P=e=>e>=200&&e<300?"green":e>=300&&e<400?"blue":e>=400&&e<500?"orange":e>=500?"red":"default",A=()=>{const e=v.value.filter((e=>e.key&&e.value));if(0===e.length)return"";const a=new URLSearchParams;return e.forEach((e=>{a.append(e.key,e.value)})),`?${a.toString()}`},R=async()=>{if(!k.id)return void y.Ay.warning("请先选择一个 API 接口");a.value=!0;const e=Date.now();try{let a=k.path;"GET"===k.method&&(a+=A());const l={"Content-Type":"application/json",Accept:"application/json"};o.value&&(l["X-API-Key"]=o.value);const n={method:k.method,headers:l};if("GET"!==k.method&&p.value)try{n.body=JSON.stringify(JSON.parse(p.value))}catch(t){y.Ay.warning("请求体不是有效的 JSON 格式，将按原样发送"),n.body=p.value}const s=await fetch(a,n);i.value=s.status,d.value=Date.now()-e;const r=[];s.headers.forEach(((e,a)=>{r.push({name:a,value:e})})),c.value=r;const v=s.headers.get("content-type")||"";v.includes("application/json")?u.value=await s.json():v.includes("text/")?u.value=await s.text():u.value=`[二进制数据 - ${v}]`,y.Ay.success(`请求成功，状态码: ${s.status}`)}catch(l){y.Ay.error("发送请求失败: "+l.message),i.value=0,d.value=Date.now()-e,c.value=[],u.value={error:l.message}}finally{a.value=!1}},T=()=>{t.value=[{id:1,name:"获取聊天完成",path:"/api/v1/chat/completions",method:"POST",description:"发送消息到模型并获取回复",request_schema:{messages:[{role:"system",content:"你是一个有用的AI助手。"},{role:"user",content:"你好，请介绍一下自己。"}],stream:!1,template_type:"general"}},{id:2,name:"分析图像",path:"/api/v1/analyze-image",method:"POST",description:"分析图像并获取描述",request_schema:{image_url:"https://example.com/image.jpg",prompt:"描述这张图片"}},{id:3,name:"知识库搜索",path:"/api/v1/knowledge/search",method:"POST",description:"在知识库中搜索相关内容",request_schema:{query:"如何使用知识库搜索功能?",kb_ids:[1,2],limit:5}},{id:4,name:"获取提示词模板",path:"/api/v1/templates/",method:"GET",description:"获取所有提示词模板"},{id:5,name:"获取知识库列表",path:"/api/v1/knowledge/",method:"GET",description:"获取所有知识库"}]},I=()=>{b(),_()};return I(),{loading:e,sending:a,endpoints:t,searchKeyword:n,currentEndpoint:k,apiKeys:r,selectedApiKey:o,requestBody:p,queryParams:v,response:u,responseStatus:i,responseTime:d,responseHeaders:c,headerColumns:h,activeResponseTab:s,filteredEndpoints:g,formattedResponse:f,selectEndpoint:F,onSearch:E,formatJson:w,clearRequestBody:K,addQueryParam:C,removeQueryParam:S,getStatusColor:P,sendRequest:R}}};var h=t(4093);const g=(0,h.A)(k,[["render",v],["__scopeId","data-v-20689566"]]),f=g}}]);
//# sourceMappingURL=608.ff916493.js.map