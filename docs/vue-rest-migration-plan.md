# Django 到 Vue + REST 框架迁移计划

## 背景

当前系统正在从传统的Django视图模式迁移到Django REST框架+Vue前端架构，但有多个功能尚未完成迁移。本文档记录剩余需要迁移的功能和实施计划。

## 功能迁移状态

### 1. 服务管理功能 ✅

**原功能描述**：
- 通过管理界面控制服务的启动/停止
- 监控服务状态
- 管理服务配置

**已完成迁移**：
- ServiceControl模型的REST API (序列化器、ViewSet)
- 服务管理前端界面 (ServiceManager.vue)
- 服务状态实时监控功能 (定时轮询)

### 2. 模型配置管理功能 ✅

**原功能描述**：
- 管理AI模型的配置参数
- 切换激活的模型
- 调整模型运行参数

**已完成迁移**：
- ModelConfig模型的REST API (序列化器、ViewSet)
- 模型配置前端界面 (ModelConfigManager.vue)
- 模型切换和参数调整功能

### 3. 知识库分块功能 ✅

**原功能描述**：
- 管理知识库的细粒度分块
- 查看和编辑分块内容
- 管理分块的向量化状态

**已完成迁移**：
- KnowledgeChunk模型的REST API (序列化器、ViewSet)
- 分块管理前端界面 (已集成到KnowledgeBase.vue中)
- 分块向量化功能

### 4. Dashboard实际数据功能 ✅

**原功能描述**：
- 显示系统概览统计数据
- 查看最近活动
- 监控系统性能指标

**已完成迁移**：
- Dashboard数据API (DashboardViewSet)
- 实际数据统计逻辑
- 前端Dashboard组件更新
- 数据可视化图表

### 5. API监控功能 ❌

**原功能描述**：
- 记录API调用情况
- 分析API性能
- 监控错误率和响应时间

**待完成**：
- API调用记录模型和API
- API监控前端界面
- 性能分析功能

### 6. 用户认证与登录 ❌

**原功能描述**：
- 用户登录和会话管理
- 基于Token的API认证
- 权限控制

**待完成**：
- JWT认证机制
- 登录页面和表单
- Token管理和刷新逻辑
- 前端路由守卫和权限验证

### 7. 用户管理 ❌

**原功能描述**：
- 用户创建和编辑
- 角色和权限管理
- 用户列表和详情查看

**待完成**：
- 用户模型REST API
- 用户管理前端界面
- 角色和权限设置功能

### 8. API密钥管理 ❌

**原功能描述**：
- 创建和管理API访问密钥
- 密钥权限和使用限制
- 密钥使用情况监控

**待完成**：
- APIKey模型REST API
- 密钥管理前端界面
- 密钥生成和验证功能

## 实施计划与进度

### 阶段1: 服务管理功能迁移 ✅

1. 创建ServiceControl序列化器 ✅
2. 实现ServiceControlViewSet，包含启动/停止服务功能 ✅
3. 配置API路由 ✅
4. 开发Vue前端服务管理界面 ✅
5. 实现服务状态实时更新 ✅

**已完成**

### 阶段2: 模型配置管理功能迁移 ✅

1. 创建ModelConfig序列化器 ✅
2. 实现ModelConfigViewSet，包含激活/切换模型功能 ✅
3. 配置API路由 ✅
4. 开发Vue前端模型配置界面 ✅
5. 实现模型参数调整功能 ✅

**已完成**

### 阶段3: 知识库分块功能迁移 ✅

1. 创建KnowledgeChunk序列化器 ✅
2. 实现KnowledgeChunkViewSet ✅
3. 配置API路由 ✅
4. 扩展KnowledgeBase前端界面，添加分块管理功能 ✅
5. 实现分块向量化功能 ✅

**已完成**

### 阶段4: Dashboard实际数据功能迁移 ✅

1. 创建Dashboard数据API ✅
2. 实现统计数据计算逻辑 ✅
3. 更新Dashboard前端组件使用实际数据 ✅
4. 添加图表和数据可视化 ✅

**已完成**

### 阶段5: API监控功能迁移 ❌

1. 创建APICall模型和序列化器 ❌
2. 实现APICallViewSet和监控逻辑 ❌
3. 开发API监控前端界面 ❌
4. 实现数据分析和可视化 ❌

**预计工时**: 3天

### 阶段6: 用户认证与登录 ❌

1. 实现JWT认证机制 ❌
2. 创建登录和令牌管理API ❌
3. 开发登录界面 ❌
4. 实现前端认证状态管理 ❌
5. 添加路由守卫 ❌

**预计工时**: 2天

### 阶段7: 用户管理功能迁移 ❌

1. 创建User序列化器和ViewSet ❌
2. 实现用户权限和角色管理 ❌
3. 开发用户管理前端界面 ❌
4. 实现用户编辑和权限设置功能 ❌

**预计工时**: 2天

### 阶段8: API密钥管理功能迁移 ❌

1. 创建APIKey序列化器和ViewSet ❌
2. 实现密钥生成和验证逻辑 ❌
3. 开发密钥管理前端界面 ❌
4. 实现密钥权限和限制功能 ❌

**预计工时**: 2天

## 下一步工作

根据功能完成情况，建议下一步实施：

1. 实现用户认证与登录功能，这是保障系统安全的基础
2. 实现用户管理功能，便于管理系统使用者
3. 实现API密钥管理功能，为API访问提供安全保障
4. 实现API监控功能，提供API使用情况的分析

具体实施顺序：

1. 用户认证与登录：
   - 实现JWT认证机制
   - 创建登录页面和认证流程
   - 添加前端路由守卫

2. 用户管理：
   - 实现用户CRUD功能
   - 添加角色和权限管理

3. API密钥管理：
   - 实现密钥生成和验证
   - 开发密钥管理界面

4. API监控：
   - 创建API调用记录功能
   - 实现监控和分析界面

## 注意事项

1. 保持与原有API的兼容性
2. 确保功能迁移后的测试覆盖率
3. 逐步迁移，避免影响正在使用的功能
4. 优先实现核心功能，再添加扩展功能 